{% extends "layout.html" %}

{% block title %}Inspection Records{% endblock %}

{% block main %}
<div class="container mt-4">
    <h2>List of Forms</h2>

<form method="post">
    <label for="forms.id">Select a form:</label>
    <select name="forms.id" id="forms.id" required>
        <option value="">-- Choose a form --</option>
        {% for form in forms %}
            <option value="{{ form.id }}" {% if form.id == selected_form_id|int %}selected{% endif %}>
                {{ form.name }}
            </option>
        {% endfor %}
    </select>
    <button type="submit">Show Inspections</button>
</form>

{% if selected_form_id %}
    <hr>
    <h3>Your Inspections for this Form:</h3>

    {% if inspections %}
        <ul>
        {% for inspection in inspections %}
            <li>
                Date: {{ inspection.submitted_at }} |
                Score: {{ inspection.score }} |
                Notes: {{ inspection.notes or 'None' }}
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>You haven't submitted any inspections for this form.</p>
    {% endif %}

    <form action="/inspection_new" method="get">
        <input type="hidden" name="forms.id" value="{{ selected_form_id }}">
        <button type="submit">Add New Inspection</button>
    </form>
{% endif %}
</div>
{% endblock %}